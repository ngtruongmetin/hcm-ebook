<%- include('partials/header', { title: title }) %>

<div class="container mt-4" style="max-width:900px;">
  <a href="/admin" class="btn btn-link">&larr; Quay lại Dashboard</a>

  <div class="card">
    <div class="card-body">
      <h4><%= article ? 'Sửa bài báo' : 'Tạo bài báo mới' %></h4>

      <form method="post" action="<%= article ? '/admin/special/edit/'+article.id : '/admin/special/new' %>" enctype="multipart/form-data">
        <div class="form-group">
          <label>Tiêu đề</label>
          <input name="title" class="form-control" value="<%= article ? article.title : '' %>" required>
        </div>
        <div class="form-group">
          <label>Tóm tắt</label>
          <textarea name="summary" class="form-control"><%= article ? article.summary : '' %></textarea>
        </div>
        <div class="form-group">
          <label>Nội dung</label>
          <textarea id="editor" name="content" class="form-control" rows="10"><%= article ? article.content : '' %></textarea>
        </div>
        <div class="form-group">
          <label>Ảnh cover</label>
          <input type="file" name="cover" class="form-control-file">
          <% if (article && article.cover) { %>
            <p>Ảnh hiện tại: <a href="<%= article.cover %>" target="_blank">Xem</a></p>
          <% } %>
        </div>
        <div class="form-group">
          <label>File đính kèm</label>
          <input type="file" name="attachment" class="form-control-file">
          <% if (article && article.attachment) { %>
            <p>File hiện tại: <a href="<%= article.attachment %>" target="_blank">Tải</a></p>
          <% } %>
        </div>

        <div class="form-group form-check">
          <input type="checkbox" class="form-check-input" name="published" id="published" <%= article && article.published ? 'checked' : '' %>>
          <label class="form-check-label" for="published">Published</label>
        </div>

        <button class="btn btn-primary">Lưu</button>
      </form>

    </div>
  </div>
</div>

<!-- CKEditor 5 CDN -->
<script src="https://cdn.ckeditor.com/ckeditor5/41.2.1/classic/ckeditor.js"></script>

<script>

  // content: full editor with image upload
  if (document.querySelector('#editor')) {
    ClassicEditor
      .create(document.querySelector('#editor'), {
        ckfinder: { uploadUrl: '/admin/upload-image' },
        toolbar: [
          'heading', '|',
          'bold', 'italic', 'underline', 'link', 'imageUpload', '|',
          'bulletedList', 'numberedList', '|',
          'insertTable', 'blockQuote', '|',
          'undo', 'redo'
        ]
      })
      .catch(err => console.error(err));
  }
</script>

<%- include('partials/footer') %>
